<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love PTP‚ù§Ô∏è</title>
<style>
  body {margin:0;height:100vh;background:black;overflow:hidden;}
  canvas {display:block;position:fixed;top:0;left:0;width:100%;height:100%;}
  .copyright {position:fixed;bottom:10px;left:50%;transform:translateX(-50%);
    font-size:clamp(0.7rem,2.5vw,1rem);color:rgba(255,255,255,0.7);
    font-family:sans-serif;text-shadow:0 0 5px #000;user-select:none;text-align:center;}
  .menu {position:fixed;bottom:25px;right:25px;z-index:20;}
  .menu button {background:rgba(255,255,255,0.15);border:2px solid rgba(255,255,255,0.3);
    border-radius:50%;width:60px;height:60px;color:white;font-size:24px;cursor:pointer;
    backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
    box-shadow:0 4px 12px rgba(0,0,0,0.4);transition:transform 0.4s ease,background 0.3s;}
  .menu button:hover {background:rgba(255,255,255,0.3);}
  .menu.open #mainBtn {transform:rotate(180deg);}
  .submenu {display:flex;flex-direction:column;gap:12px;position:absolute;bottom:70px;right:0;}
  .submenu button {width:50px;height:50px;font-size:20px;opacity:0;
    transform:translateY(20px) rotate(-30deg);transition:opacity 0.4s ease,transform 0.4s ease;
    pointer-events:none;}
  .submenu.show button {opacity:1;transform:translateY(0) rotate(0);pointer-events:auto;}
  .submenu.show button:nth-child(1){transition-delay:0.05s;}
  .submenu.show button:nth-child(2){transition-delay:0.1s;}
  .submenu.show button:nth-child(3){transition-delay:0.15s;}
  .submenu.show button:nth-child(4){transition-delay:0.2s;}
  .submenu.show button:nth-child(5){transition-delay:0.25s;}
  #imageUpload {display:none;}

  /* Popup nh·∫≠p ch·ªØ */
  .popup {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 50;
  }
  .popup-content {
    background: white;
    padding: 20px;
    border-radius: 12px;
    text-align: center;
    width: 300px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
  }
  .popup-content h2 {
    margin-bottom: 15px;
    font-family: sans-serif;
  }
  .popup-content input {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #ccc;
    margin-bottom: 15px;
  }
  .popup-content button {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin: 5px;
    font-weight: bold;
  }
  .save-btn {background: #4caf50; color: white;}
  .save-btn:hover {background: #43a047;}
  .close-btn {background: #f44336; color: white;}
  .close-btn:hover {background: #d32f2f;}
</style>
</head>
<body>
  <canvas id="heartCanvas"></canvas>
  <div class="copyright">Copyright-Phan Tr·ªçng Ph√∫c Coder</div>

  <!-- Menu -->
  <div class="menu">
    <button id="mainBtn">‚öôÔ∏è</button>
    <div class="submenu" id="submenu">
      <button onclick="fontScale += 0.2">üîº</button>
      <button onclick="fontScale = Math.max(0.5, fontScale - 0.2)">üîΩ</button>
      <button onclick="fontScale = defaultFontScale">üîÑ</button>
      <button onclick="openPopup()">‚úçÔ∏è</button>
      <button onclick="document.getElementById('imageUpload').click()">üñºÔ∏è</button>
    </div>
  </div>

  <!-- input ch·ªçn ·∫£nh (·∫©n) -->
  <input type="file" id="imageUpload" accept="image/*" multiple onchange="updateImages(event)">

  <!-- Popup nh·∫≠p ch·ªØ -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <h2>Nh·∫≠p ch·ªØ</h2>
      <input type="text" id="popupText" placeholder="Nh·∫≠p ch·ªØ c·ªßa b·∫°n...">
      <br>
      <button class="save-btn" onclick="saveText()">L∆∞u</button>
      <button class="close-btn" onclick="closePopup()">ƒê√≥ng</button>
    </div>
  </div>

<script>
const canvas=document.getElementById("heartCanvas");
const ctx=canvas.getContext("2d");
function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;}
resizeCanvas();window.addEventListener("resize",resizeCanvas);

// === SAO ===
let starsBg=[];
function createStars(){starsBg=[];const numStars=window.innerWidth<500?80:200;
  for(let i=0;i<numStars;i++){starsBg.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,
    radius:Math.random()*1.2,opacity:Math.random(),blinkSpeed:Math.random()*0.02+0.005});}}
createStars();window.addEventListener("resize",createStars);

// === ·∫¢NH BAY ===
let imageSources=[
  "images/4.jpeg",
  "images/5.jpeg",
  "images/6.jpeg"
];
let bgImages=[];
function createRandomImages(){bgImages=[];for(let i=0;i<12;i++){const imgObj={img:new Image(),
  x:Math.random()*canvas.width,y:Math.random()*canvas.height,vx:(Math.random()-0.5)*6,
  vy:(Math.random()-0.5)*6,size:Math.random()*0.08+0.06};
  imgObj.img.src=imageSources[Math.floor(Math.random()*imageSources.length)];
  bgImages.push(imgObj);}}
createRandomImages();
function drawBackgroundImages(){bgImages.forEach(obj=>{if(obj.img.complete){obj.x+=obj.vx;obj.y+=obj.vy;
  if(obj.x<-100)obj.x=canvas.width+50;if(obj.x>canvas.width+100)obj.x=-50;
  if(obj.y<-100)obj.y=canvas.height+50;if(obj.y>canvas.height+100)obj.y=-50;
  const imgSize=Math.min(canvas.width,canvas.height)*obj.size;ctx.save();ctx.globalAlpha=0.35;
  ctx.drawImage(obj.img,obj.x,obj.y,imgSize,imgSize);ctx.restore();}});}

// === SAO BƒÇNG ===
let shootingStars=[];
function createShootingStar(){return{x:Math.random()*canvas.width*0.8,y:Math.random()*canvas.height*0.3,
  length:Math.random()*120+80,speed:Math.random()*6+6,angle:Math.PI/4+(Math.random()*0.3-0.15),
  opacity:Math.random()*0.5+0.7,life:Math.random()*150+150,isBright:true};}
function initShootingStars(){shootingStars=[];const count=window.innerWidth<500?2:3;
  for(let i=0;i<count;i++)shootingStars.push(createShootingStar());}
initShootingStars();window.addEventListener("resize",initShootingStars);
function drawShootingStars(){shootingStars.forEach(star=>{ctx.save();ctx.shadowColor="white";ctx.shadowBlur=40;
  const endX=star.x-Math.cos(star.angle)*star.length;const endY=star.y-Math.sin(star.angle)*star.length;
  const gradient=ctx.createLinearGradient(star.x,star.y,endX,endY);
  gradient.addColorStop(0,`rgba(255,255,255,${star.opacity})`);
  gradient.addColorStop(0.3,`rgba(200,200,255,${star.opacity*0.8})`);
  gradient.addColorStop(1,"rgba(255,255,255,0)");ctx.strokeStyle=gradient;ctx.beginPath();
  ctx.moveTo(star.x,star.y);ctx.lineTo(endX,endY);ctx.lineWidth=3;ctx.stroke();ctx.restore();
  star.x+=Math.cos(star.angle)*star.speed;star.y+=Math.sin(star.angle)*star.speed;star.life--;
  if(star.x>canvas.width||star.y>canvas.height||star.life<=0){Object.assign(star,createShootingStar());
    star.x=Math.random()*canvas.width*0.3;star.y=Math.random()*canvas.height*0.3;}});}

// === TR√ÅI TIM H·∫†T ===
let particles=[];let heartbeat=0;let scale=1;
function createParticles(){particles=[];const numParticles=window.innerWidth<500?100:200;
  scale=Math.min(window.innerWidth,window.innerHeight)/35;
  function heartFunction(t){const x=16*Math.sin(t)**3;const y=-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));return{x,y};}
  for(let i=0;i<numParticles;i++){const t=(i/numParticles)*Math.PI*2;const {x,y}=heartFunction(t);
    particles.push({baseX:x*scale,baseY:y*scale,size:Math.random()*2+1,angle:Math.random()*Math.PI*2,speed:Math.random()*0.02+0.01});}}
createParticles();window.addEventListener("resize",createParticles);

// === FONT SCALE ===
let fontScale=2.2;const defaultFontScale=2.2;
const mainBtn=document.getElementById("mainBtn");const submenu=document.getElementById("submenu");const menu=document.querySelector(".menu");
mainBtn.addEventListener("click",()=>{submenu.classList.toggle("show");menu.classList.toggle("open");});

// === TEXT & IMAGE UPDATE ===
let displayText = "Phan Tr·ªçng Ph√∫c Coder"; // ch·ªØ m·∫∑c ƒë·ªãnh

// popup
function openPopup() {
  document.getElementById("popup").style.display = "flex";
  document.getElementById("popupText").value = displayText;
}
function closePopup() {
  document.getElementById("popup").style.display = "none";
}
function saveText() {
  const val = document.getElementById("popupText").value;
  if (val.trim() !== "") {
    displayText = val;
  }
  closePopup();
}

function updateImages(event) {
  const files = event.target.files;
  if (files.length > 0) {
    imageSources.length = 0;
    for (let i = 0; i < files.length; i++) {
      const url = URL.createObjectURL(files[i]);
      imageSources.push(url);
    }
    createRandomImages();
  }
}

// === ANIMATE ===
function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);
// Sao nh·∫•p nh√°y
starsBg.forEach(star=>{star.opacity+=star.blinkSpeed;if(star.opacity>1||star.opacity<0)star.blinkSpeed*=-1;
  ctx.beginPath();ctx.arc(star.x,star.y,star.radius,0,Math.PI*2);
  ctx.fillStyle=`rgba(255,255,255,${star.opacity})`;ctx.fill();});
// Sao bƒÉng
drawShootingStars();
// ·∫¢nh n·ªÅn
drawBackgroundImages();

ctx.save();ctx.translate(canvas.width/2,canvas.height/2);
heartbeat+=0.05;const pulseStrength=(Math.sin(heartbeat)+1)/2;
// Ch·ªØ
ctx.save();ctx.font=`bold ${scale*fontScale}px sans-serif`;ctx.fillStyle="white";ctx.textAlign="center";
ctx.shadowColor="rgba(255,0,120,0.9)";ctx.shadowBlur=20;ctx.lineWidth=3;ctx.strokeStyle="rgba(255,0,0,0.6)";
ctx.strokeText(displayText,0,0);ctx.fillText(displayText,0,0);ctx.restore();
// Tim
const r=255;const g=Math.floor(102*pulseStrength);const b=Math.floor(178*pulseStrength);const color=`rgb(${r},${g},${b})`;
particles.forEach(p=>{p.angle+=p.speed;const jitterX=Math.cos(p.angle)*2;const jitterY=Math.sin(p.angle)*2;
  ctx.beginPath();ctx.arc(p.baseX+jitterX,p.baseY+jitterY,p.size,0,Math.PI*2);
  ctx.shadowBlur=20*pulseStrength;ctx.shadowColor=color;ctx.fillStyle=color;ctx.fill();});
ctx.restore();requestAnimationFrame(animate);}
animate();
</script>
</body>
</html>